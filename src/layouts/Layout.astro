---
import Sidebar from "../components/Sidebar.astro";
import "../styles/global.css";

interface Props {
  title: string;
  description?: string;
}

const {
  title,
  description = "Kabir's portfolio website showcasing DevOps and cloud infrastructure expertise",
} = Astro.props;
---

<!doctype html>
<html lang="en" class="overflow-x-hidden">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={description} />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=5.0, viewport-fit=cover, shrink-to-fit=no"
    />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <meta name="theme-color" content="#111111" />
    <style is:inline>
      /* Critical inline styles to prevent FOUC and ensure no horizontal scrolling */
      html,
      body {
        max-width: 100%;
        overflow-x: hidden;
        margin: 0;
        padding: 0;
      }
      * {
        box-sizing: border-box;
      }
    </style>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <title>{title}</title>
  </head>
  <body
    class="min-h-screen overflow-x-hidden bg-gradient-to-br from-background to-background/95 text-foreground antialiased"
  >
    <!-- Background subtle grid pattern -->
    <div
      class="absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiMyMDIwMjAiIGZpbGwtb3BhY2l0eT0iMC4wNSI+PHBhdGggZD0iTTM2IDM0djJoLTJ2LTJoMnptMC00aDJ2MmgtMnYtMnptLTQgMHYyaC0ydi0yaDJ6bTIgMGgydjJoLTJ2LTJ6Ii8+PC9nPjwvZz48L3N2Zz4=')] opacity-50"
    >
    </div>

    <div class="flex min-h-screen relative overflow-x-hidden content-wrapper">
      <Sidebar />
      <main
        id="main-content"
        class="flex-1 p-4 md:p-6 ml-0 md:ml-64 transition-all duration-300 ease-in-out relative z-10 overflow-x-hidden w-full"
      >
        <div
          class="transition-all duration-250 ease-in-out opacity-100 translate-y-0 mx-auto responsive-text"
          style="width: 100%; max-width: min(100%, 72rem);"
        >
          <slot />
        </div>
      </main>
    </div>

    <script>
      // Add scroll restoration and smooth anchor links
      document.addEventListener("DOMContentLoaded", () => {
        // Handle anchor links with smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
          anchor.addEventListener("click", (e) => {
            const href = anchor.getAttribute("href");
            if (href && href !== "#") {
              e.preventDefault();
              const target = document.querySelector(href);
              if (target) {
                target.scrollIntoView({
                  behavior: "smooth",
                });
              }
            }
          });
        });

        // // Fix horizontal scrolling more aggressively
        // function preventHorizontalScroll() {
        //   // Apply to html and body
        //   document.documentElement.style.overflow = "hidden auto";
        //   document.documentElement.style.overflowX = "hidden";
        //   document.documentElement.style.maxWidth = "100%";
        //   document.body.style.overflow = "hidden auto";
        //   document.body.style.overflowX = "hidden";
        //   document.body.style.maxWidth = "100%";
        //   document.body.style.width = "100%";

        //   // Apply to main content
        //   const mainContent = document.getElementById("main-content");
        //   if (mainContent) {
        //     (mainContent as HTMLElement).style.overflow = "hidden auto";
        //     (mainContent as HTMLElement).style.overflowX = "hidden";
        //     (mainContent as HTMLElement).style.maxWidth = "100%";
        //     (mainContent as HTMLElement).style.width = "100%";
        //     (mainContent as HTMLElement).style.boxSizing = "border-box";

        //     // Apply to immediate children of main content
        //     Array.from(mainContent.children).forEach((child) => {
        //       (child as HTMLElement).style.maxWidth = "100%";
        //       (child as HTMLElement).style.overflow = "hidden";
        //       (child as HTMLElement).style.wordWrap = "break-word";
        //       (child as HTMLElement).style.boxSizing = "border-box";
        //     });
        //   }
        // }

        // // Apply immediately
        // // preventHorizontalScroll();

        // // Apply on window resize
        // window.addEventListener("resize", preventHorizontalScroll);

        // Detect mobile devices for optimized interactions
        const isMobile = window.matchMedia("(max-width: 768px)").matches;
        if (isMobile) {
          // Add touch event optimizations for mobile
          document.documentElement.classList.add("is-mobile");

          // Additional mobile fixes
          document.body.style.touchAction = "pan-y";
        }
      });
    </script>
  </body>
</html>
